<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>徐子超的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="华中科技大学，就职于今日头条，此为博客一枚。">
<meta property="og:type" content="website">
<meta property="og:title" content="徐子超的博客">
<meta property="og:url" content="http://xuzichao.com/index.html">
<meta property="og:site_name" content="徐子超的博客">
<meta property="og:description" content="华中科技大学，就职于今日头条，此为博客一枚。">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="徐子超的博客">
<meta name="twitter:description" content="华中科技大学，就职于今日头条，此为博客一枚。">
  
    <link rel="alternative" href="/atom.xml" title="徐子超的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/assets/photo.png">
  
  <link rel="stylesheet" href="/css/style.css">
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?0b8e8ee87e4708173f00d9048c309301";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
  })();
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/assets/photo.png" class="js-avatar" style="width: 100%;height: 100%;opacity: 1;">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">卡图睡不醒</a></h1>
		</hgroup>

		
		<p class="header-subtitle">程先生，你好。客气，叫我序员吧。</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="weibo" target="_blank" href="http://weibo.com/2356167600/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" title="weibo">weibo</a>
					        
								<a class="facebook" target="_blank" href="https://www.facebook.com/zichao.xu.5" title="facebook">facebook</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/时光相册/" style="font-size: 15px;">时光相册</a> <a href="/tags/程序开发/" style="font-size: 20px;">程序开发</a> <a href="/tags/随笔小结/" style="font-size: 10px;">随笔小结</a>
					</div>
				</section>
				
				
				

				
				
				<section class="switch-part switch-part3">
				
					<div id="js-aboutme">IOS开发,毕业于华中科技大学,今日头条在职</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">卡图睡不醒</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/assets/photo.png" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">卡图睡不醒</h1>
			</hgroup>
			
			<p class="header-subtitle">程先生，你好。客气，叫我序员吧。</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="weibo" target="_blank" href="http://weibo.com/2356167600/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" title="weibo">weibo</a>
			        
						<a class="facebook" target="_blank" href="https://www.facebook.com/zichao.xu.5" title="facebook">facebook</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-2016高考毕业生本科专业选择推荐" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/06/12/2016高考毕业生本科专业选择推荐/" class="article-date">
  	<time datetime="2016-06-12T11:09:59.000Z" itemprop="datePublished">Jun 12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/12/2016高考毕业生本科专业选择推荐/">2016高考毕业生本科专业选择推荐</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>普通高校本科专业选择推荐</p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>此文针对2016届高考毕业生就读普通大学本科专业推荐，推荐凭借自己的社会认识和对众多所在对应专业的同学学习从业动向判定而得，等高考成绩出来了，结合本省排名、个人意向、专业招生人数、专业往年招生分数，即可快速定位。本文是我表弟16年高考结束，成绩还没出来前特意针对他个人给预备着的，所以带有少许的个人色彩，发布出来是仅仅作为参考，希望能看到的考生们有些作用，作者本人拥有最终解释权。</p>
<p>徐子超 (<a href="http://xuzichao.com">http://xuzichao.com</a>)</p>
<p>2016.6.12</p>
<h2 id="可选专业"><a href="#可选专业" class="headerlink" title="可选专业"></a>可选专业</h2><h3 id="01学科门类：哲学-（所有门类不考虑）"><a href="#01学科门类：哲学-（所有门类不考虑）" class="headerlink" title="01学科门类：哲学 （所有门类不考虑）"></a>01学科门类：哲学 <font color="blue">（所有门类不考虑）</font></h3><h3 id="02学科门类：经济学-（所有门类可选）"><a href="#02学科门类：经济学-（所有门类可选）" class="headerlink" title="02学科门类：经济学  （所有门类可选）"></a>02学科门类：经济学  <font color="red">（所有门类可选）</font></h3><blockquote>
<p> 0201 经济学类 </p>
</blockquote>
<pre><code>* 020101 经济学

* 020102 经济统计学
</code></pre><blockquote>
<p>0202 财政学类</p>
</blockquote>
<pre><code>* 020201K 财政学

* 020202 税收学
</code></pre><blockquote>
<p>0203 金融学类</p>
</blockquote>
<pre><code>* 020301K 金融学

* 020302 金融工程

* 020303 保险学

* 020304 投资学
</code></pre><blockquote>
<p>0204 经济与贸易类</p>
</blockquote>
<pre><code>* 020401 国际经济与贸易

* 020402 贸易经济
</code></pre><h3 id="03学科门类：法学-（其他门类不考虑）"><a href="#03学科门类：法学-（其他门类不考虑）" class="headerlink" title="03学科门类：法学  （其他门类不考虑）"></a>03学科门类：法学  <font color="blue">（其他门类不考虑）</font></h3><blockquote>
<p>030101K 法学 <font color="red">（可选）</font></p>
</blockquote>
<h3 id="04学科门类：教育学-（所有门类不考虑）"><a href="#04学科门类：教育学-（所有门类不考虑）" class="headerlink" title="04学科门类：教育学  （所有门类不考虑）"></a>04学科门类：教育学  <font color="blue">（所有门类不考虑）</font></h3><h3 id="05学科门类：文学-（其他门类不考虑）"><a href="#05学科门类：文学-（其他门类不考虑）" class="headerlink" title="05学科门类：文学  （其他门类不考虑）"></a>05学科门类：文学  <font color="blue">（其他门类不考虑）</font></h3><blockquote>
<p>0502 外国语言文学类 <font color="red">（可选）</font></p>
<p>0503 新闻传播学类 <font color="red">（可选）</font></p>
</blockquote>
<pre><code>050301 新闻学

050302 广播电视学

050303 广告学

050304 传播学

050305 编辑出版学
</code></pre><h3 id="06学科门类：历史学-（所有门类不考虑）"><a href="#06学科门类：历史学-（所有门类不考虑）" class="headerlink" title="06学科门类：历史学  （所有门类不考虑）"></a>06学科门类：历史学  <font color="blue">（所有门类不考虑）</font></h3><h3 id="07学科门类：理学-（其他门类不考虑）"><a href="#07学科门类：理学-（其他门类不考虑）" class="headerlink" title="07学科门类：理学  （其他门类不考虑）"></a>07学科门类：理学  <font color="blue">（其他门类不考虑）</font></h3><blockquote>
<p>0701 数学类  <font color="red">（可选）</font></p>
</blockquote>
<pre><code>070101 数学与应用数学

070102 信息与计算科学
</code></pre><blockquote>
<p>0712 统计学类 <font color="red">（可选）</font></p>
</blockquote>
<pre><code>071201 统计学

071202 应用统计学
</code></pre><h3 id="08学科门类：工学-（全部门类可选，分程度）"><a href="#08学科门类：工学-（全部门类可选，分程度）" class="headerlink" title="08学科门类：工学 （全部门类可选，分程度）"></a>08学科门类：工学 <font color="red">（全部门类可选，分程度）</font></h3><blockquote>
<p>0801 力学类  <font color="green">（最后）</font></p>
</blockquote>
<pre><code>080101 理论与应用力学
</code></pre><blockquote>
<p>0802 机械类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>080201 机械工程

080202 机械设计制造及其自动化

080203 材料成型及控制工程

080204 机械电子工程

080205 工业设计

080206 过程装备与控制工程

080207 车辆工程

080208 汽车服务工程
</code></pre><blockquote>
<p>0803 仪器类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>080301 测控技术与仪器
</code></pre><blockquote>
<p>0804 材料类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>080401 材料科学与工程

080402 材料物理（注：可授工学或理学学士学位）

080403 材料化学（注：可授工学或理学学士学位）

080404 冶金工程

080405 金属材料工程

080406 无机非金属材料工程

080407 高分子材料与工程

080408 复合材料与工程
</code></pre><blockquote>
<p>0805 能源动力类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>080501 能源与动力工程
</code></pre><blockquote>
<p>0806 电气类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>080601 电气工程及其自动化
</code></pre><blockquote>
<p>0807 电子信息类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>080701 电子信息工程（注：可授工学或理学学士学位）

080702 电子科学与技术（注：可授工学或理学学士学位）

080703 通信工程

080704 微电子科学与工程（注：可授工学或理学学士学位）

080705光电信息科学与工程（注：可授工学或理学学士学位）

080706 信息工程
</code></pre><blockquote>
<p>0808 自动化类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>080801 自动化
</code></pre><blockquote>
<p>0809 计算机类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>080901 计算机科学与技术（注：可授工学或理学学士学位）

080902 软件工程

080903 网络工程

080904K 信息安全（注：可授工学或理学或管理学学士学位）

080905 物联网工程

080906 数字媒体技术
</code></pre><blockquote>
<p>0810 土木类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>081001 土木工程

081002 建筑环境与能源应用工程

081003 给排水科学与工程

081004 建筑电气与智能化
</code></pre><blockquote>
<p>0811 水利类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>081101 水利水电工程

081102 水文与水资源工程

081103 港口航道与海岸工程
</code></pre><blockquote>
<p>0812 测绘类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>081201 测绘工程

081202 遥感科学与技术
</code></pre><blockquote>
<p>0813 化工与制药类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>081301 化学工程与工艺

081302 制药工程
</code></pre><blockquote>
<p>0814 地质类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>081401 地质工程

081402 勘查技术与工程

081403 资源勘查工程
</code></pre><blockquote>
<p>0815 矿业类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>081501 采矿工程

081502 石油工程

081503 矿物加工工程

081504 油气储运工程
</code></pre><blockquote>
<p>0816 纺织类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>081601 纺织工程

081602 服装设计与工程（注：可授工学或艺术学学士学位）
</code></pre><blockquote>
<p>0817 轻工类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>081701 轻化工程

081702 包装工程

081703 印刷工程
</code></pre><blockquote>
<p>0818 交通运输类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>081801 交通运输

081802 交通工程

081803K 航海技术

081804K 轮机工程

081805K 飞行技术
</code></pre><blockquote>
<p>0819 海洋工程类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>081901 船舶与海洋工程
</code></pre><blockquote>
<p>0820 航空航天类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>082001 航空航天工程

082002 飞行器设计与工程

082003 飞行器制造工程

082004 飞行器动力工程

082005 飞行器环境与生命保障工程
</code></pre><blockquote>
<p>0821 兵器类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>082101 武器系统与工程

082102 武器发射工程

082103 探测制导与控制技术

082104 弹药工程与爆炸技术

082105 特种能源技术与工程

082106 装甲车辆工程

082107 信息对抗技术
</code></pre><blockquote>
<p>0822 核工程类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>082201 核工程与核技术

082202 辐射防护与核安全

082203 工程物理

082204 核化工与核燃料工程
</code></pre><blockquote>
<p>0823 农业工程类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>082301 农业工程

082302 农业机械化及其自动化

082303 农业电气化

082304 农业建筑环境与能源工程

082305 农业水利工程
</code></pre><blockquote>
<p>0824 林业工程类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>082401 森林工程

082402 木材科学与工程

082403 林产化工
</code></pre><blockquote>
<p>0825 环境科学与工程类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>082501 环境科学与工程

082502 环境工程

082503 环境科学（注：可授工学或理学学士学位）

082504 环境生态工程
</code></pre><blockquote>
<p>0826 生物医学工程类<font color="green">（最后）</font></p>
</blockquote>
<pre><code>082601 生物医学工程（注：可授工学或理学学士学位）
</code></pre><blockquote>
<p>0827 食品科学与工程类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>082701 食品科学与工程（注：可授工学或农学学士学位）

082702 食品质量与安全

082703 粮食工程

082704 乳品工程

082705 酿酒工程
</code></pre><blockquote>
<p>0828 建筑类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>082801 建筑学

082802 城乡规划

082803 风景园林（注：可授工学或艺术学学士学位）
</code></pre><blockquote>
<p>0829 安全科学与工程类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>082901 安全工程
</code></pre><blockquote>
<p>0830 生物工程类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>083001 生物工程
</code></pre><blockquote>
<p>0831 公安技术类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>083101K 刑事科学技术

083102K 消防工程
</code></pre><h3 id="09学科门类：农学-（所有门类不考虑）"><a href="#09学科门类：农学-（所有门类不考虑）" class="headerlink" title="09学科门类：农学 （所有门类不考虑）"></a>09学科门类：农学 <font color="blue">（所有门类不考虑）</font></h3><h3 id="10学科门类：医学-（所有门类可考虑，分程度）"><a href="#10学科门类：医学-（所有门类可考虑，分程度）" class="headerlink" title="10学科门类：医学 （所有门类可考虑，分程度）"></a>10学科门类：医学 <font color="red">（所有门类可考虑，分程度）</font></h3><blockquote>
<p>1001 基础医学类  <font color="green">（其次）</font></p>
</blockquote>
<pre><code>100101K 基础医学
</code></pre><blockquote>
<p>1002 临床医学类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>100201K 临床医学
</code></pre><blockquote>
<p>1003 口腔医学类 <font color="green">（优先）</font></p>
</blockquote>
<pre><code>100301K 口腔医学
</code></pre><blockquote>
<p>1004 公共卫生与预防医学类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>100401K 预防医学

100402 食品卫生与营养学
</code></pre><blockquote>
<p>1005 其次医学类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>100501K 其次医学

100502K 针灸推拿学

100503K 藏医学

100504K 蒙医学

100505K 维医学

100506K 壮医学

100507K 哈医学
</code></pre><blockquote>
<p>1006 其次西医结合类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>100601K 其次西医临床医学
</code></pre><blockquote>
<p>1007 药学类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code> 100701 药学

100702 药物制剂
</code></pre><blockquote>
<p>1008 其次药学类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>100801 其次药学

100802 其次药资源与开发
</code></pre><blockquote>
<p>1009 法医学类 <font color="green">（其次）</font></p>
<p>1010 医学技术类 <font color="green">（其次）</font></p>
</blockquote>
<pre><code>101001 医学检验技术

101002 医学实验技术

101003 医学影像技术

101004 眼视光学

101005 康复治疗学

101006 口腔医学技术

101007 卫生检验与检疫
</code></pre><blockquote>
<p>1011 护理学类 <font color="green">（最后）</font></p>
</blockquote>
<pre><code>101101 护理学
</code></pre><h3 id="12学科门类：管理学-（其他门类不考虑）"><a href="#12学科门类：管理学-（其他门类不考虑）" class="headerlink" title="12学科门类：管理学 （其他门类不考虑）"></a>12学科门类：管理学 <font color="blue">（其他门类不考虑）</font></h3><blockquote>
<p>1201 管理科学与工程类  <font color="red">（可选）</font></p>
</blockquote>
<pre><code>120101 管理科学

120102 信息管理与信息系统

120103 工程管理

120104 房地产开发与管理

120105 工程造价
</code></pre><blockquote>
<p>1202 工商管理类  <font color="red">（可选）</font></p>
</blockquote>
<pre><code>120201K 工商管理

120202 市场营销

120203K 会计学

120204 财务管理

120205 国际商务

120206 人力资源管理

120207 审计学

120208 资产评估
120209 物业管理

120210 文化产业管理
</code></pre><h3 id="13学科门类：艺术学-（其他门类不考虑）"><a href="#13学科门类：艺术学-（其他门类不考虑）" class="headerlink" title="13学科门类：艺术学   （其他门类不考虑）"></a>13学科门类：艺术学   <font color="blue">（其他门类不考虑）</font></h3><blockquote>
<p>1305 设计学类 <font color="red">（可选）</font></p>
</blockquote>
<pre><code>130501 艺术设计学

130502 视觉传达设计

130503 环境设计

130504 产品设计

130505 服装与服饰设计

130506 公共艺术

130507 工艺美术

130508 数字媒体艺术
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/随笔小结/">随笔小结</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-IOS音频录制 --- AVFoundation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/02/01/IOS音频录制 --- AVFoundation/" class="article-date">
  	<time datetime="2015-02-01T11:09:59.000Z" itemprop="datePublished">Feb 1</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/02/01/IOS音频录制 --- AVFoundation/">IOS音频录制</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="IOS-音频录制-—-AVFoundation"><a href="#IOS-音频录制-—-AVFoundation" class="headerlink" title="IOS 音频录制 — AVFoundation"></a>IOS 音频录制 — AVFoundation</h2><p>我们已经讲解了视频的录制所需要使用的一些API以及方式方法，都是建立在AVFoundation框架基础上，这次我们继续讲解此框架基础上的音频录制。一般场景有录制语音并播放；当静音开关被关闭的时候，音频怎么播放；当闹钟和手机电话响起的时候，音频播放做什么样的处理等等，整个交互都将使用到 AVAudioSession ，打通音频硬件设备到软件数据流的关键。</p>
<p><img src="/assets/images/aspg_intro_2x.png" alt=""></p>
<h2 id="一、概念引导"><a href="#一、概念引导" class="headerlink" title="一、概念引导"></a>一、概念引导</h2><h3 id="1、创建Audio-Session"><a href="#1、创建Audio-Session" class="headerlink" title="1、创建Audio Session"></a>1、创建Audio Session</h3><p>当你的APP启动之后，你就获得了一个单利的session,通过它你可以决定音乐上的各种使用场景，可以配置音频录制的参数，直接连接音频硬件。</p>
<p>1) 默认行为 （AVAudioSessionCategorySoloAmbient）</p>
<p>可以回放，关闭录制，静音键关闭则音量播放关闭，锁屏时候音量关闭，当其他音量想起，你的播放直接关闭。</p>
<p>当你开始录制的时候，你的session在运行，结束后你可以关闭，能够自己忽略的播放系统运行api的有<system sound="" services="" reference="">和<audio ui="" sounds="">。</audio></system></p>
<p>2) 合并行为AVCaptureSession</p>
<p>AVCaptureSession AVCaptureDevice在录制视频的时候也是一起录制了音频的，这是因为AVCaptureSession会默认的配置AVAudioSession，我们可以通过设置automaticallyConfiguresApplicationAudioSession为NO，然后自己去配置AVAudioSession。</p>
<p>3）MPVolumeView</p>
<p>为用户显示一个滑块控件设置系统音频输出音量和一个按钮选择音频输出路线。当第一次显示,滑块的位置反映了当前系统音频输出音量，当用户拖动滑块,体积变化更新，如果用户按下设备播放时,声音音量按钮滑块移动到反映新的体积。</p>
<p>4）一般方法举例：</p>
<ul>
<li>sharedInstance</li>
</ul>
<ul>
<li>otherAudioPlaying</li>
<li>requestRecordPermission</li>
<li>availableCategories</li>
<li>setActive:error:</li>
</ul>
<h3 id="2、使用类别Categories"><a href="#2、使用类别Categories" class="headerlink" title="2、使用类别Categories"></a>2、使用类别Categories</h3><p>1) 行为类别分布：</p>
<p>类作为一个关键值，定义了一组app的音频行为。苹果在iOS的未来版本可能细化分类行为。你最好的策略是选择最准确地描述了你的意图的类别音频你想要的行为，它们都遵循“last in wins” 规则。<br><img src="/assets/images/1.pic.jpg" alt=""></p>
<p>2）选用特殊话的模式</p>
<ul>
<li>AVAudioSessionModeVoiceChat—For Voice over IP (VoIP) apps</li>
<li>AVAudioSessionModeVideoChat—For video chat apps such as FaceTime</li>
<li>AVAudioSessionModeGameChat—For game apps</li>
<li>AVAudioSessionModeVideoRecording—For apps that use the camera to capture video</li>
<li>AVAudioSessionModeMoviePlayback—For apps that play movies.</li>
<li>AVAudioSessionModeMeasurement—For apps that processing to input and output signals.</li>
</ul>
<p><img src="/assets/images/2.pic.jpg" alt=""></p>
<h3 id="3、响应中断事件"><a href="#3、响应中断事件" class="headerlink" title="3、响应中断事件"></a>3、响应中断事件</h3><p>中断事件可以来自电话、闹钟、日历提醒、siri等。</p>
<p>1) 响应的处理过程：</p>
<p><img src="/assets/images/3.pic.jpg" alt=""></p>
<p>2）监听响应的方式：</p>
<ul>
<li><p>AVAudioSession 通知</p>
<p>  AVAudioSessionInterruptionNotification<br>AVAudioSessionRouteChangeNotification<br>AVAudioSessionMediaServicesWereLostNotification<br>AVAudioSessionMediaServicesWereResetNotification<br>AVAudioSessionSilenceSecondaryAudioHintNotification</p>
</li>
<li><p>AV Foundation framework</p>
<p>  AVAudioPlayer如果正在音频播放过程中可以有对应的代理来接收事件，AVAudioPlayerDelegate,同样也有对应的AVAudioRecorderDelegate ，都显示IOS8以后废弃掉。</p>
</li>
<li><p>Audio Queue Services, I/O audio unit</p>
</li>
<li>OpenAL ，Notification</li>
<li><p>System Sound Services</p>
<p>  发生则直接静音，中断终止可以重新再次播放，无需额外处理。</p>
</li>
</ul>
<h3 id="4、优化硬件音频数据"><a href="#4、优化硬件音频数据" class="headerlink" title="4、优化硬件音频数据"></a>4、优化硬件音频数据</h3><ul>
<li>指定首选硬件设置采样率和I / O的缓冲时间</li>
<li>查询许多硬件特征,其中包括输入和输出延迟,输入和输出通道数,硬件采样率、硬件体积设定,是否可用的音频输入应对设备具体通知最常用的属性值更改事件路线变化,覆盖在应对变化。</li>
<li>编写回调侦听硬件输出音量的变化和变化的可用性的音频输入。</li>
</ul>
<h3 id="5、响应路线变化"><a href="#5、响应路线变化" class="headerlink" title="5、响应路线变化"></a>5、响应路线变化</h3><p>作为您的应用程序运行时,用户可能插入或拔掉耳机,或者使用接上音频连接等，通过注册AVAudioSessionRouteChangeNotification通知去响应。<br><img src="/assets/images/audio_route_change_2x.png" alt=""></p>
<h3 id="6、调整音频会话的球员"><a href="#6、调整音频会话的球员" class="headerlink" title="6、调整音频会话的球员"></a>6、调整音频会话的球员</h3><p>从用户的音乐播放音频库以及你自己的声音，多个播放器混合播放。针对游戏App、音频记录播放App、VOIP聊天App、音频计量App等，要随时切换和配置类型。</p>
<h2 id="2、代码实践"><a href="#2、代码实践" class="headerlink" title="2、代码实践"></a>2、代码实践</h2><blockquote>
<h3 id="import-“TTAudioPlayer-h”"><a href="#import-“TTAudioPlayer-h”" class="headerlink" title="#import “TTAudioPlayer.h”"></a>#import “TTAudioPlayer.h”</h3><h3 id="import-“TTAudioRecorder-h”"><a href="#import-“TTAudioRecorder-h”" class="headerlink" title="#import “TTAudioRecorder.h”"></a>#import “TTAudioRecorder.h”</h3></blockquote>
<h2 id="3、问题回顾"><a href="#3、问题回顾" class="headerlink" title="3、问题回顾"></a>3、问题回顾</h2><h3 id="1、WAV转化AMR声音变形："><a href="#1、WAV转化AMR声音变形：" class="headerlink" title="1、WAV转化AMR声音变形："></a>1、WAV转化AMR声音变形：</h3><h4 id="现象："><a href="#现象：" class="headerlink" title="现象："></a>现象：</h4><p>录制WAV格式本地正常播放，转化为AMR后，把AMR格式文件在电脑端播放，声音严重变形，无法识别，再转化会WAV,，手机还是无法识别。</p>
<h4 id="原因与解决"><a href="#原因与解决" class="headerlink" title="原因与解决"></a>原因与解决</h4><p>声音格式转化采用的是#include “amrFileCodec.h”，一个第三方常用转化库libopencore，并且没有找到第二个转化库，它对转化的音频输入源是有格式要求的，要求转化的采样率为标准的8k，如果录制的音频频率采用高频率44.1K的话就会出现变形，我想这里的设定依据来自于amr格式的采样率为8K。</p>
<p>AMR格式：</p>
<blockquote>
<p>维基百科    </p>
<p>采样率 8 kHz/13-bit (160 采样点每20ms)，滤波后只保留 200-3400 Hz 范围内的信号.</p>
<p>编码器使用8个位速：12.2、10.2、7.95、7.40、6.70、5.90、5.15和4.75 kbit/s.</p>
</blockquote>
<p>amrFileCodec_h:</p>
<blockquote>
<p>#define AMR_MAGIC_NUMBER “#!AMR\n”</p>
<p>#define PCM_FRAME_SIZE 160 // 8khz 8000*0.02=160</p>
<p>#define MAX_AMR_FRAME_SIZE 32</p>
<p>#define AMR_FRAME_COUNT_PER_SECOND 50</p>
</blockquote>
<h3 id="2、先转后播一直长时间等待："><a href="#2、先转后播一直长时间等待：" class="headerlink" title="2、先转后播一直长时间等待："></a>2、先转后播一直长时间等待：</h3><h4 id="现象：-1"><a href="#现象：-1" class="headerlink" title="现象："></a>现象：</h4><p>界面UI点击播放之后，一直处于播放状态但是没有声音。</p>
<h4 id="原因与解决-1"><a href="#原因与解决-1" class="headerlink" title="原因与解决"></a>原因与解决</h4><ul>
<li>UI状态显示问题，与AUDIO有一个实际的播放误差，以为需要等待一段的转化时间，但实际上以及音频已经播放失败，导致多次重复点击，最后界面显示一直未播放中，但实际上，音频本身早就停止播放，这是由于对界面事件响应以及player实际播放状态判断的不完整导致。</li>
<li>网络错误请求，音频数据的源的请求返回错误，UI显示为在播放，实际返回错误。这与服务端有关系，经抓包查实，同样参数同样网络的相同请求有可能出现成功和失败两种结果。</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/程序开发/">程序开发</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-IOS视频录制--AVFoudation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/01/28/IOS视频录制--AVFoudation/" class="article-date">
  	<time datetime="2015-01-28T11:09:59.000Z" itemprop="datePublished">Jan 28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/01/28/IOS视频录制--AVFoudation/">IOS视频录制</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="IOS-视频录制-—-AVFoundation"><a href="#IOS-视频录制-—-AVFoundation" class="headerlink" title="IOS 视频录制 — AVFoundation"></a>IOS 视频录制 — AVFoundation</h1><p>AVFoundation是为数不多的几个框架,您可以使用和创建基于时间的视听媒体。它提供了一个objective - c接口用于工作与基于时间的视听数据详细的级别。例如,您可以使用它来检查,创建、编辑或reencode媒体文件。你也可以输入流从设备和操作视频实时捕捉和回放。</p>
<h2 id="一、概念引导："><a href="#一、概念引导：" class="headerlink" title="一、概念引导："></a>一、概念引导：</h2><h3 id="1、ASSets媒体文件"><a href="#1、ASSets媒体文件" class="headerlink" title="1、ASSets媒体文件:"></a>1、ASSets媒体文件:</h3><p>1）AVAsset</p>
<p>一个抽象类来表示时间等视听媒体视频和声音。每个资产包含一组跟踪旨在呈现或加工在一起,一个统一的媒体类型,包括但不限于音频、视频、文本、关闭字幕,字幕。</p>
<p>AVURLAsset *anAsset = [[AVURLAsset alloc] initWithURL:url options:nil];属性有<br>tracks、duration、preferredVolume、preferredTransform等等。</p>
<p>2) 一个AVAssetTrack</p>
<p>对象提供了所有资产提供track-level检查接口,方便对ASSets进行更具体的属性获取以及对应的操作。</p>
<p>3）AVAssetImageGenerator</p>
<p>对象提供缩略图或预览图像的资产独立于回放，可以生成单独的图片，也可以生成图片队列，这是获取视频缩略图的方式之一，还有另外两种ALAsset的thumbnail 和 - (UIImage *)imageFromSampleBuffer:(CMSampleBufferRef)sampleBuffer。</p>
<p>4）AVAssetExportSession</p>
<p>针对AVAsset源对象的内容进行转码，创建一个被指定输出形式的资源。</p>
<p><img src="/assets/images/AVAssetExportSession.jpg" alt=""></p>
<h3 id="2、Playback播放控制"><a href="#2、Playback播放控制" class="headerlink" title="2、Playback播放控制:"></a>2、Playback播放控制:</h3><p>1) AVPlayer</p>
<p>你使用一个AVPlayer对象来实现控制器和用户接口单一或多种条目回放。</p>
<ul>
<li><p>-  (instancetype)initWithPlayerItem:(AVPlayerItem *)item</p>
</li>
<li><p>play 、 parse 、 end</p>
</li>
<li><p>- (void)seekToTime:(CMTime)time</p>
</li>
</ul>
<p>2) AVPlayerLayer</p>
<p>用于显示视频内容，相当于大屏幕。里面有videoGravity，默认值 AVLayerVideoGravityResizeAspect.</p>
<p>3) AVPlayerItem</p>
<p>一个AVPlayerItem代表资产的表现状态,由一个AVPlayer对象和可以观察到的状态。对视频播放状态修改一起监听的过程多数发生在正对这个对象的操作操作上，比如：</p>
<ul>
<li>seekToTime，从哪里开始播放</li>
<li>各种资源播放状态的通知AVPlayerItemFailedToPlayToEndTimeNotification<br>等</li>
</ul>
<p>4) AVPlayerItemTrack </p>
<p>你用一个AVPlayerItemTrack对象修改资产的表现状态跟踪(AVAssetTrack)一个AVPlayer对象。通常视频的加载播放有各种状态，我们需要KVO监听或者添加通知去知道播放器的准备、进行、暂停、停止等状态。</p>
<p>5) AVQueuePlayer</p>
<p>按照队列播放视频</p>
<ul>
<li><p>queuePlayerWithItems，</p>
</li>
<li><p>insertItem:(AVPlayerItem *)item</p>
<pre><code>afterItem:(AVPlayerItem *)afterItem
</code></pre></li>
</ul>
<h3 id="3、Editing资源编辑"><a href="#3、Editing资源编辑" class="headerlink" title="3、Editing资源编辑:"></a>3、Editing资源编辑:</h3><p>AVFoundation框架提供了一个功能丰富的组类促进视听资产的编辑。AVFoundation的编辑API的核心成分，就是一组追踪从一个或多个不同的媒体资产。AVMutableComposition类提供了一个接口,用于插入和删除操作的痕迹,以及管理自己时间排序。</p>
<p><img src="/assets/images/AVMutableComposition.jpg" alt=""></p>
<p>1）AVMutableComposition</p>
<p>是一个可变的AVComposition子类，当您想要从现有资产创建一个新的资源。你可以添加和删除跟踪,可以添加、删除和时间范围。<br>比如：</p>
<ul>
<li>– insertEmptyTimeRange：可以增加一段空白时间</li>
</ul>
<ul>
<li>– insertTimeRange:ofAsset:atTime:error:<br>插入的所有跟踪给定的时间范围内指定的资产到接收机。</li>
</ul>
<!-- -->
<pre><code>AVAsset *videoAsset = &lt;#AVAsset with at least one video track#&gt;;
AVAsset *anotherVideoAsset = &lt;#another AVAsset with at least one video track#&gt;;
// Get the first video track from each asset.
AVAssetTrack *videoAssetTrack = [[videoAsset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];
AVAssetTrack *anotherVideoAssetTrack = [[anotherVideoAsset tracksWithMediaType:AVMediaTypeVideo] objectAtIndex:0];
// Add them both to the composition.
[mutableCompositionVideoTrack insertTimeRange:CMTimeRangeMake(kCMTimeZero,videoAssetTrack.timeRange.duration) ofTrack:videoAssetTrack atTime:kCMTimeZero error:nil];
[mutableCompositionVideoTrack insertTimeRange:CMTimeRangeMake(kCMTimeZero,anotherVideoAssetTrack.timeRange.duration) ofTrack:anotherVideoAssetTrack atTime:videoAssetTrack.timeRange.duration error:nil];&apos;
</code></pre><p>2) AVMutableAudioMix </p>
<p>一个AVMutableAudioMix对象管理混合音轨的输入参数。它允许自定义音频处理在回放期间音轨或执行其他操作。</p>
<!--0-->
<pre><code>AVMutableAudioMix *mutableAudioMix = [AVMutableAudioMix audioMix];
// Create the audio mix input parameters object.
AVMutableAudioMixInputParameters *mixParameters = [AVMutableAudioMixInputParameters audioMixInputParametersWithTrack:mutableCompositionAudioTrack];
// Set the volume ramp to slowly fade the audio out over the duration of the composition.
[mixParameters setVolumeRampFromStartVolume:1.f toEndVolume:0.f timeRange:CMTimeRangeMake(kCMTimeZero, mutableComposition.duration)];
// Attach the input parameters to the audio mix.
mutableAudioMix.inputParameters = @[mixParameters];
</code></pre><h3 id="4、Media-Capture媒体捕捉"><a href="#4、Media-Capture媒体捕捉" class="headerlink" title="4、Media Capture媒体捕捉:"></a>4、Media Capture媒体捕捉:</h3><p>1) AVCaptureDevice </p>
<p>代表输入设备,如摄像头或麦克风</p>
<p>2) AVCaptureInput </p>
<p>输入设备的配置端口，我们可以理解为输入</p>
<p>3）AVCaptureSession</p>
<p>协调数据流从输入到输出,用startRunning开始从输入到输出的数据流,并调用stopRunning停止流动。采取关闭代理，保证取景器一直流动。</p>
<p>4) AVCaptureOutput </p>
<ul>
<li><p>AVCaptureMovieFileOutput，输入到视频文件，代理AVCaptureFileOutputRecordingDelegate</p>
</li>
<li><p>AVCaptureVideoDataOutput，如果想要实时的处理每一帧数据，或想要有自己的图形动画，代理AVCaptureVideoDataOutputSampleBufferDelegate</p>
</li>
</ul>
<ul>
<li><p>AVCaptureAudioDataOutput ，音频数据，代理AVCaptureVideoDataOutputSampleBufferDelegate</p>
</li>
<li><p>AVCaptureStillImageOutput ，图片数据</p>
</li>
</ul>
<p>5）AVCaptureVideoPreviewLayer </p>
<p>实时展示被session传出出来的视频流数据，也就是我们的取景器</p>
<p>6）AVCaptureConnection </p>
<p>代表捕获之间的连接输入和输出对象关联到一个捕获会话。</p>
<p><img src="/assets/images/AVCaptureConnection.jpg" alt=""></p>
<h3 id="5、Export媒体输出"><a href="#5、Export媒体输出" class="headerlink" title="5、Export媒体输出:"></a>5、Export媒体输出:</h3><p>1) AVAssetExportSession</p>
<p>针对AVAsset对象转码，创建一个输出的形式被指定出口预设内容。包括对输出媒体资源的属性设定，可以设置presetName进行视频品质压缩，AVAssetExportPresetLowQuality等。也可以设置属性包括：outputFileType<br>、fileLengthLimit、timeRange<br>等。</p>
<p>2）AVAssetReader </p>
<p>直接从媒体读取存储样本,获得样本解码成可渲染的形式。组合资产多个音轨和组合多个视频跟踪(通过使用AVAssetReaderAudioMixOutput和AVAssetReaderVideoCompositionOutput)。</p>
<ul>
<li>addOutPut</li>
<li>startReading</li>
<li>cancelReading</li>
</ul>
<p>读取一个音频：</p>
<!--0-->
<pre><code>AVAudioMix *audioMix = &lt;#An AVAudioMix that specifies how the audio tracks from the AVAsset are mixed#&gt;;
// Assumes that assetReader was initialized with an AVComposition object.
AVComposition *composition = (AVComposition *)assetReader.asset;
// Get the audio tracks to read.
NSArray *audioTracks = [composition tracksWithMediaType:AVMediaTypeAudio];
// Get the decompression settings for Linear PCM.
NSDictionary *decompressionAudioSettings = @{ AVFormatIDKey : [NSNumber numberWithUnsignedInt:kAudioFormatLinearPCM] };
// Create the audio mix output with the audio tracks and decompression setttings.
AVAssetReaderOutput *audioMixOutput = [AVAssetReaderAudioMixOutput assetReaderAudioMixOutputWithAudioTracks:audioTracks audioSettings:decompressionAudioSettings];
// Associate the audio mix used to mix the audio tracks being read with the output.
audioMixOutput.audioMix = audioMix;
// Add the output to the reader if possible.
if ([assetReader canAddOutput:audioMixOutput])
[assetReader addOutput:audioMixOutput];
</code></pre><p>3) AVAssetWriter</p>
<p>使用一个AVAssetWriter对象媒体数据写入新文件指定视听的容器类型,如QuickTime电影文件或一个mp4文件,支持自动交叉媒体数据的多个并发的痕迹。</p>
<ul>
<li>initWithURL:fileType:error:</li>
<li>startWriting</li>
<li>startSessionAtSourceTime</li>
<li>addInput</li>
<li>endSessionAtSourceTime</li>
<li>finishWritingWithCompletionHandler</li>
</ul>
<h2 id="二、代码实践："><a href="#二、代码实践：" class="headerlink" title="二、代码实践："></a>二、代码实践：</h2><blockquote>
<h3 id="import-“TTCameraViewController-h”"><a href="#import-“TTCameraViewController-h”" class="headerlink" title="#import “TTCameraViewController.h”"></a>#import “TTCameraViewController.h”</h3></blockquote>
<h2 id="三、问题回顾："><a href="#三、问题回顾：" class="headerlink" title="三、问题回顾："></a>三、问题回顾：</h2><h3 id="1、视频文件写入崩溃："><a href="#1、视频文件写入崩溃：" class="headerlink" title="1、视频文件写入崩溃："></a>1、视频文件写入崩溃：</h3><h4 id="现象："><a href="#现象：" class="headerlink" title="现象："></a>现象：</h4><p>相机开始拍摄就会出现崩溃，时而出现，有时难以复现。</p>
<h4 id="原因与解决："><a href="#原因与解决：" class="headerlink" title="原因与解决："></a>原因与解决：</h4><p>1）startSessionAtSourceTime只能在 AVAssetWriterStatusWriting的之后调用，但是startWriting调用之后writer并没有立即变为writing状态，而已有一个极短的开始时间，参照苹果规范使用文档，只需要前面调用之后后面就可以跟着执行startSessionAtSourceTime，然而，我遇见了这问题，说明它并不是。随后我到stackoverflow上查了问题，发现有人早就提过，并没有答案，说是升级IOS8以后就没有了，可我这里是IOS9…随后我只能判断writer状态如果是writing就开始执行，如果不是就调用startWriting。</p>
<p>2）[videoWriterInput appendSampleBuffer：xxx]这只能在startSessionAtSourceTime开始之后调用，和1是同样的情况，明明第一行调用了startSessionAtSourceTime，第二调用appendSampleBuffer就会崩溃，并且依旧是偶尔发生。但是这里的问题是没有一个状态可以判断是否已经开始startSessionAtSourceTime，这里就有点血崩了，不能像问题1一样判断解决，后来只好try catch了,稳住局面防止崩溃，丢失极少的毫秒级帧数。</p>
<h3 id="2、相机拍摄闪烁抖动："><a href="#2、相机拍摄闪烁抖动：" class="headerlink" title="2、相机拍摄闪烁抖动："></a>2、相机拍摄闪烁抖动：</h3><h4 id="现象：-1"><a href="#现象：-1" class="headerlink" title="现象："></a>现象：</h4><p>开始拍摄时候，取景器闪烁抖动，引起一小部分可见范围内的视频内容发送抖动，并被存入文件中，体验差。</p>
<h4 id="原因与解决：-1"><a href="#原因与解决：-1" class="headerlink" title="原因与解决："></a>原因与解决：</h4><p>在开始拍摄的时候，再去创建connection并传递设备和拍摄方向，有利于视频获取oritation，自然而然的横着拍摄也会竖着播放，但是问题在于connection的建立产生较大的链接，引起视频抖动，此抖动将被录制进入视频文件中。于是我采取在初始化input的时候就把connection就增加进去，当开始拍摄的时候不会发生抖动，但是牺牲的是视频的oritation需要自己根据用户拍摄的方向去手动修改视频方向。</p>
<h3 id="3、视频方向混乱："><a href="#3、视频方向混乱：" class="headerlink" title="3、视频方向混乱："></a>3、视频方向混乱：</h3><h4 id="现象：-2"><a href="#现象：-2" class="headerlink" title="现象："></a>现象：</h4><p>背面摄像头拍摄，home键在下，拍摄出来的视频文件，在播放的时候，底部在手机右边，而不是底边，一次类推，home键在底部与视频的底部角度成90垂直关系。</p>
<h4 id="原因与解决：-2"><a href="#原因与解决：-2" class="headerlink" title="原因与解决："></a>原因与解决：</h4><!--0-->
<pre><code>self.videoOutPut = [[AVCaptureVideoDataOutput alloc] init];
NSDictionary * outputSettings = [[NSDictionary alloc] initWithObjectsAndKeys:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA],(id)kCVPixelBufferPixelFormatTypeKey, nil];
[self.videoOutPut setVideoSettings:outputSettings];

//必须
if ([self.session canAddOutput:self.videoOutPut]) {
    [self.session addOutput:self.videoOutPut];
}

//先于
self.videoConnection = [self.videoOutPut connectionWithMediaType:AVMediaTypeVideo];
self.videoConnection.enabled = NO;
[self.videoConnection setVideoOrientation:AVCaptureVideoOrientationPortrait];
</code></pre><h3 id="4、横着拍摄的视频横着播放："><a href="#4、横着拍摄的视频横着播放：" class="headerlink" title="4、横着拍摄的视频横着播放："></a>4、横着拍摄的视频横着播放：</h3><h4 id="现象：-3"><a href="#现象：-3" class="headerlink" title="现象："></a>现象：</h4><p>横着拍摄的视频，放的时候是竖着的。</p>
<h4 id="原因与解决：-3"><a href="#原因与解决：-3" class="headerlink" title="原因与解决："></a>原因与解决：</h4><p>因为上面解决视频抖动，导致不能直接设定拍摄时候的视频方向，从而需要根据手动的拍摄方向去修改视频的视图的方向。<br>考虑到用户可能锁住屏幕旋转，于是就CMMotionManager获取重力方向来判断，在VC出现或者开始拍摄的时候开启，在VC退出或者拍摄完成的的时候关闭。获得方向后，在视频的写入里直接修改方向即可。</p>
<!--0-->
<pre><code>[videoWriterInput setTransform:CGAffineTransformScale(CGAffineTransformMakeRotation(-M_PI_2), 1.0, 1.0)];
</code></pre><h3 id="5、录制视频有右边和底边绿色线条："><a href="#5、录制视频有右边和底边绿色线条：" class="headerlink" title="5、录制视频有右边和底边绿色线条："></a>5、录制视频有右边和底边绿色线条：</h3><h4 id="现象：-4"><a href="#现象：-4" class="headerlink" title="现象："></a>现象：</h4><p>手机全屏录制的时候，设置视频输出宽度为手机的宽高，当宽高为基数的时候视频录制里面会出现绿色线条。</p>
<h4 id="原因与解决：-4"><a href="#原因与解决：-4" class="headerlink" title="原因与解决："></a>原因与解决：</h4><p>不知道原因，神奇的bug，参照着段子的视频方法解决的，直接修改视频输出宽高为偶数。</p>
<!--0-->
<pre><code>NSInteger videoWidth = [[NSNumber numberWithFloat:self.view.frame.size.width] integerValue];
NSInteger videoHeight = [[NSNumber numberWithFloat:self.view.frame.size.height] integerValue];
if (videoWidth % 2 == 1) {
    videoWidth = videoWidth - 1;
}
if (videoHeight % 2 == 1) {
    videoHeight = videoHeight - 1;
}
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/程序开发/">程序开发</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Hexo-个人博客使用介绍" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/07/Hexo-个人博客使用介绍/" class="article-date">
  	<time datetime="2014-11-07T11:09:59.000Z" itemprop="datePublished">Nov 7</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/07/Hexo-个人博客使用介绍/">Hexo一下，博客诞生</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="个人博客搭建推荐Hexo"><a href="#个人博客搭建推荐Hexo" class="headerlink" title="个人博客搭建推荐Hexo"></a>个人博客搭建推荐Hexo</h2><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>事实上，好早之前就尝试过自己搭建的个人博客，想积累写写技术知识点和生活上的见闻，希望它作为自己个人的一块土地去耕耘。通常我们会在一些博客网站注册，比如博客园，然后开始作文，但这样的博客网站的界面UI设计挺糟糕的，作为还有一些审美的我不太乐意去使用，虽然同为苦逼码农。后来出了一些品质比较高的静态博客等，也尝试去使用过，最后还是选择了使用博客组件去搭建，因为总觉得独立的才是自己的，大概程序员的内心都流淌着这样的独白。</p>
<p>博客搭建框架组件很多，从WordPress到FarBox、Jekyll、Octopress、ghost、marboo、Hexo等等，他们基本都配合github使用,在网上各路大神的推荐之下，试过几款框架,基本都是在读完安装说明并开始有点小激动的时候，痛苦的安装过程让我放弃了这一方式。现在回想，一方面是由于个人那些年的电脑和网络都很烂，另一方面也是自己年轻冲动没经验和耐心，搭建过程很多东西都需要一点点的搜索去学习，电脑一卡一慢就各种不爽就搞不下去了。不过最后我还是搭建了自己的博客，并没有使用上述的哪种框架,前面的过程学习并知道了博客的搭建方式，索性自己就用FW设计了个人博客的UI界面，正好也会前端FE，就手写了博客页面Css和JS，这样博客的结界面就出来了，自己动手丰衣足食，然而它只是个静态的…到编译这一环节过不去了，毕竟JS属于前端的江湖，咋整…于是找了个python脚本(这里感谢@上山打老虎的友情赞助)，动态编译产生静态文件，只需要专心的写文字就好，随后可上传到github通过域名映射直接展示。这样，我就搭建好了自己的博客，高端大气上档次，简直满意的不得了！结果是非常符合我自己的审美设计要求，内心那个开心呐，随后开始了我的博客之路。</p>
<p>到后来接触了Hexo,它就是我上述过程的一个更为优化的方案，功能完善，扩展强大。通过Hexo的使用也发现上手很快，我几乎是在几分钟之内就搭建起了博客，这速度让我为之欢呼，所以我决定转到Hexo来写作，那么，这里就写个文章来推荐一下吧。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><blockquote>
<p>安装说明</p>
</blockquote>
<h5 id="一、准备工作"><a href="#一、准备工作" class="headerlink" title="一、准备工作"></a>一、准备工作</h5><ul>
<li><p>你得有自己的域名，买域名的地方比较多，有的坑有的好，我是在godaddy上买的。</p>
</li>
<li><p>注册github账号，你将会免费使用到它提供的各种便利而强大的功能，免费的存储空间，下载开源项目等等。</p>
</li>
<li><p>安装Node.js, npm</p>
</li>
<li><p>安装git,生成SSH-KEY管理权限，配置域名到github关联，网上多查查</p>
</li>
</ul>
<h5 id="二、安装Hexo"><a href="#二、安装Hexo" class="headerlink" title="二、安装Hexo"></a>二、安装Hexo</h5><p>1、hexo程序环境</p>
<blockquote>
<p>npm install -g hexo</p>
</blockquote>
<p>2、hexo工程</p>
<blockquote>
<p>$ hexo init 文件夹名称</p>
<p>$ cd 文件夹名称</p>
<p>$ npm install</p>
</blockquote>
<p>3、会得到文件夹目录</p>
<blockquote>
<p>├ ── _config.yml</p>
<p>├ ── package.json</p>
<p>├ ── scaffolds</p>
<p>├ ── source</p>
<p>├ ── _drafts</p>
<p>└ ── _posts</p>
<p>└ ── themes</p>
</blockquote>
<p>4、按照命令行操作，此时到这里，别管这些文件是干啥的，来，我们接着往下走。</p>
<h5 id="三、生成第一篇文章"><a href="#三、生成第一篇文章" class="headerlink" title="三、生成第一篇文章"></a>三、生成第一篇文章</h5><p>1、创建文章</p>
<blockquote>
<p>hexo new 你的文章名称</p>
</blockquote>
<p>2、编辑你的文章</p>
<p>上面一步在你对应的文件夹下新建了一个Markdown文件，此时需要你使用对应的语法去编写文档，不知道的可以去学习下，用语言命令号来写Word文档，该有的有，不该有的没有，简直就是最爱</p>
<p>3、编译</p>
<blockquote>
<p>hexo generate</p>
<p>hexo server</p>
</blockquote>
<p>此时打开你的浏览器，默认地址是（ <a href="http://0.0.0.0:4000/" target="_blank" rel="external">http://0.0.0.0:4000/</a> ），你就可以看到你的文章了，就是你刚才编写的文章。  </p>
<h5 id="四、发布到github"><a href="#四、发布到github" class="headerlink" title="四、发布到github"></a>四、发布到github</h5><p>由于前面你做好了准备工作，所以这里只需要</p>
<blockquote>
<p>git commit -a -m “<em>*</em>文章”</p>
<p>git push</p>
</blockquote>
<p>此时打开你的浏览器，比如你买的域名是( <a href="http://baidu.com/" target="_blank" rel="external">http://baidu.com/</a> )，你打开它，和你在（ <a href="http://0.0.0.0:4000" target="_blank" rel="external">http://0.0.0.0:4000</a> ）看到的一毛一样，可以发给你的朋友看了。 </p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>对于Hexo的使用，前后只介绍了关键的几个命令，为了可以可以快速搭建，都是基础入门很方便，麻烦的到是前面的准备工作，得一步步挨着来，有不懂的可以搜索和咨询。Hexo可以更换主题，也可以参照他人的主题制作，比如本站的主题yilia就是从github上找的开源主题，作者是我科的学长，已经获得了近2000颗星，这就是开源的力量，感谢学长litten的贡献。Hexo的其他扩展功能，请直接浏览Hexo的官网学习，我这里就不做没有必要的翻译了。</p>
<p>写作此文时候的内心OS：</p>
<p><img src="/assets/images/aoteman.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/程序开发/">程序开发</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-再见，My Hust" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/06/12/再见，My Hust/" class="article-date">
  	<time datetime="2014-06-12T11:09:59.000Z" itemprop="datePublished">Jun 12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/06/12/再见，My Hust/">再见，My Hust</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h3><p>不需要华丽的辞藻去颂赞，你的美与伟大一直浸染着每个Huster的心。</p>
<p>大学四年，匆匆，不曾写过什么日记，好像是少了些记忆，从来都认为自己大学过的很对，走的路很直，如今毕业工作再回头看，迷迷茫茫，忙忙碌碌，勤勤恳恳，便是那过去的日子。</p>
<h3 id="毕业青春"><a href="#毕业青春" class="headerlink" title="毕业青春"></a>毕业青春</h3><h3 id="华科景秀"><a href="#华科景秀" class="headerlink" title="华科景秀"></a>华科景秀</h3>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/时光相册/">时光相册</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-彩云之南" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/05/12/彩云之南/" class="article-date">
  	<time datetime="2014-05-12T11:09:59.000Z" itemprop="datePublished">May 12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/05/12/彩云之南/">彩云之南</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>跨入华科校门的时候，我说我要在大学结识一群好伙伴，到后来，我就遇见了你们，这次把我们的毕业旅行选在了彩云之南。</p>
<h3 id="记忆不散的相册"><a href="#记忆不散的相册" class="headerlink" title="记忆不散的相册"></a>记忆不散的相册</h3><p><img src="/assets/myPhoto/1.jpg" alt=""></p>
<p><img src="/assets/myPhoto/2.jpg" alt=""></p>
<p><img src="/assets/myPhoto/3.jpg" alt=""></p>
<p><img src="/assets/myPhoto/4.jpg" alt=""></p>
<p><img src="/assets/myPhoto/5.jpg" alt=""></p>
<p><img src="/assets/myPhoto/6.jpg" alt=""></p>
<p><img src="/assets/myPhoto/7.jpg" alt=""></p>
<p><img src="/assets/myPhoto/8.jpg" alt=""></p>
<p><img src="/assets/myPhoto/9.jpg" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/时光相册/">时光相册</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 卡图睡不醒
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: undefined,
		animate: undefined,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: undefined
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






  </div>
</body>
</html>